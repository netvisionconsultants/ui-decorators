{"version":3,"file":"ui-component.es5.js","sources":["../src/decorators/source.ts","../src/decorators/table.ts","../src/decorators/field.ts","../src/decorators/link.ts","../src/decorators/documentId.ts","../src/decorators/section.ts","../src/ui-component.ts"],"sourcesContent":["export function source(name: string) {\n    return function(constructor: any) {\n        constructor.prototype._source = name\n    }\n}\n","export interface TableArgs {\n    title: string\n    columns: Array<string>\n    sortOrder?: SortOrder\n    sortingColumn?: String\n    transform?: (val: Array<any>) => Array<any>\n    section?: string\n}\n\nexport enum SortOrder {\n    ASC = 'ASC',\n    DESC = 'DESC'\n}\n\nexport function createTable(\n    rows: Array<any>,\n    columns: Array<String>,\n    sortOrder?: SortOrder,\n    sortingColumn?: String,\n    transform?: (val: Array<any>) => Array<any>\n) {\n    if (!rows || rows.length === 0) return []\n\n    if (columns.length === 0) throw new Error('Columns must be provided to the table() decorator')\n\n    let sortingColumnIdx: number\n\n    if (!sortOrder) {\n        sortOrder = SortOrder.ASC\n    }\n\n    if (!sortingColumn) {\n        sortingColumn = columns[0]\n        sortingColumnIdx = 0\n    } else {\n        sortingColumnIdx = columns.indexOf(sortingColumn)\n        if (sortingColumnIdx < 0) throw new Error('sortingColumn does not exist')\n    }\n\n    const mappedRows = rows.map(row => {\n        return columns.map(column => {\n            return row[column as any]\n        })\n    })\n\n    const sortedRows = mappedRows.sort(\n        (a: any, b: any): number => {\n            if (a[sortingColumnIdx] < b[sortingColumnIdx]) {\n                return sortOrder === SortOrder.ASC ? -1 : 1\n            }\n            if (a[sortingColumnIdx] > b[sortingColumnIdx]) {\n                return sortOrder === SortOrder.ASC ? 1 : -1\n            }\n            return 0\n        }\n    )\n\n    return transform ? transform(sortedRows) : sortedRows\n}\n\nexport function table({ title, columns, sortOrder, sortingColumn, transform, section }: TableArgs) {\n    return function(target: Object, propName: string) {\n        Object.defineProperty(target, `${propName}-UITable`, {\n            get() {\n                return {\n                    title,\n                    columns,\n                    type: 'table',\n                    value: createTable(\n                        this[propName],\n                        columns,\n                        sortOrder,\n                        sortingColumn,\n                        transform\n                    ),\n                    ...(section && { section })\n                }\n            },\n            enumerable: true\n        })\n    }\n}\n","export interface FieldArgs {\n    label: string\n    displayEmpty?: boolean\n    longValue?: boolean\n    transform?: (val: any) => string\n    section?: string\n}\n\nexport function field({\n    label,\n    displayEmpty = false,\n    longValue = false,\n    transform,\n    section\n}: FieldArgs) {\n    return function(target: Object, propName: string) {\n        Object.defineProperty(target, `${propName}-UIField`, {\n            get() {\n                return {\n                    label,\n                    longValue,\n                    displayEmpty,\n                    type: 'field',\n                    value: transform ? transform(this[propName]) : this[propName],\n                    ...(section && { section })\n                }\n            },\n            enumerable: true\n        })\n    }\n}\n","export interface LinkArgs {\n    label: string\n    url: string\n    transform?: (val: any) => string\n    section?: string\n}\n\nexport function link({ label, url, transform, section }: LinkArgs) {\n    return function(target: Object, propName: string) {\n        Object.defineProperty(target, `${propName}-UILink`, {\n            get() {\n                return {\n                    label,\n                    type: 'link',\n                    url: transform ? transform(url) : url,\n                    ...(section && { section })\n                }\n            },\n            enumerable: true\n        })\n    }\n}\n","export function documentId() {\n    return function(target: Object, propName: string) {\n        Object.defineProperty(target, `_documentId`, {\n            get() {\n                return this[propName]\n            },\n            enumerable: true\n        })\n    }\n}\n","export interface Section {\n    name: string\n    title: string\n}\n\nexport function hasSection({ name, title }: Section) {\n    return function(constructor: any) {\n        if (!constructor.prototype._hasSections) {\n            constructor.prototype._hasSections = {}\n        }\n        constructor.prototype._hasSections[name] = { name, title, components: [] }\n    }\n}\n","export { source } from './decorators/source'\nexport { table, TableArgs } from './decorators/table'\nexport { field, FieldArgs } from './decorators/field'\nexport { link, LinkArgs } from './decorators/link'\nexport { documentId } from './decorators/documentId'\nexport { hasSection, Section } from './decorators/section'\n\nexport interface Component {\n    components: Array<any>\n    source: any\n    documentId: any\n}\n\nexport default class UIComponent {\n    renderComponent() {\n        let sections: any\n        const body: Component = {\n            components: [],\n            documentId: '',\n            source: ''\n        }\n\n        if ((this as any)['_hasSections']) {\n            sections = (this as any)['_hasSections']\n        }\n\n        for (let k in this) {\n            if (k.endsWith('UIField') || k.endsWith('UITable') || k.endsWith('UILink')) {\n                const component: any = this[k]\n                if (component.section) {\n                    sections[component.section].components.push(this[k])\n                } else {\n                    body.components.push(component)\n                }\n            }\n            if (k === '_source') {\n                body.source = this[k]\n            }\n            if (k === '_documentId') {\n                body.documentId = this[k]\n            }\n        }\n        for (const key in sections) {\n            body.components.push({\n                type: 'section',\n                ...sections[key]\n            })\n        }\n        return body\n    }\n}\n"],"names":[],"mappings":"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"}